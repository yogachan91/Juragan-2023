{"version":3,"file":"src_app_redeem-ovo-point_redeem-ovo-point_module_ts.js","mappings":"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","sources":["./src/app/redeem-ovo-point/redeem-ovo-point-routing.module.ts","./src/app/redeem-ovo-point/redeem-ovo-point.module.ts","./src/app/redeem-ovo-point/redeem-ovo-point.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { RedeemOvoPointPage } from './redeem-ovo-point.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: RedeemOvoPointPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class RedeemOvoPointPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { RedeemOvoPointPageRoutingModule } from './redeem-ovo-point-routing.module';\n\nimport { RedeemOvoPointPage } from './redeem-ovo-point.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RedeemOvoPointPageRoutingModule\n  ],\n  declarations: [RedeemOvoPointPage]\n})\nexport class RedeemOvoPointPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { AlertController, LoadingController, ToastController } from '@ionic/angular';\nimport { DolphinService } from '../services/dolphin.service';\nimport { NavigationExtras, Router } from '@angular/router';\n\n@Component({\n  selector: 'app-redeem-ovo-point',\n  templateUrl: './redeem-ovo-point.page.html',\n  styleUrls: ['./redeem-ovo-point.page.scss'],\n})\nexport class RedeemOvoPointPage implements OnInit {\n  ovoList: any;\n  currentPoin: any;\n  selectedData: any;\n  balance: any;\n  phonenumber:any;\n  profile:any;\n  namapemilik: any;\n  OTP: any;\n  ewallettypeText: string = 'OVO';\n  ewallettype: string = 'ovo';\n  constructor(\n    private router: Router,\n    private loadingController: LoadingController,\n    private dolphinService: DolphinService,\n    private alertController: AlertController,\n    private toastController: ToastController\n    ) {\n      this.loadData()\n    }\n\n  ngOnInit() {\n    \n  }\n\n  async presentToast() {\n    const toast = await this.toastController.create({\n      icon: 'information-circle',\n      message: 'Memuat data E-Wallet, harap menunggu..',\n      color: 'dark'\n    });\n    toast.present();\n  }\n\n  async doLoading(msg) {\n    const loading = await this.loadingController.create({\n      message: msg,\n      backdropDismiss: false\n    });\n    await loading.present();\n  }\n\n  async showalert(title, message) {\n    const alert = await this.alertController.create({\n      header: title,\n      message: message,\n      buttons: ['OK'],\n    });\n  \n    await alert.present();  \n  }\n\n  loadData() {\n    this.presentToast();\n    this.selectedData = null\n    this.ovoList = null\n    \n\n    this.dolphinService.getpoint().subscribe(data => {\n      this.balance = data\n    });\n\n    this.dolphinService.getovolist().subscribe((res) => {\n      if(res.status == 'success'){\n        this.ovoList = res.retdata\n      }\n      console.log('getovolist', this.ovoList)\n      this.toastController.dismiss()\n      this.dolphinService.getdetailprofile().subscribe(data => {\n        \n        this.profile = data[0]\n        // console.log('PROFIL', this.profile)\n        this.phonenumber = this.profile.no_hp;\n        this.namapemilik = this.profile.NAMA_PEMILIK;\n        if(!this.phonenumber) {\n          this.showalert(\"Oops..\", \"Lengkapi nomor handphone pada halaman profil Anda untuk melakukan redeem E-Wallet\");\n          this.router.navigateByUrl('/', { replaceUrl: true });\n          \n        // } else if(!this.namapemilik) {\n        //   this.showalert(\"Oops..\", \"Lengkapi Nama Pemilik Outlet pada halaman profil Anda untuk melakukan redeem E-Wallet\");\n        //   this.router.navigateByUrl('/', { replaceUrl: true });\n\n        // } else {\n\n        }\n      });\n\n      \n    })\n  }\n\n  updateSelected(i) {\n    this.selectedData = i;\n    console.log('Selected', this.selectedData['amount'])\n  }\n\n  async tukarpoin() {\n    console.log('Selected', this.selectedData)\n    console.log('ewallettype', this.ewallettype)\n    let phoneNum = this.phonenumber.replace(/\\s/g,'').trim();\n    if(this.ewallettype != 'ovo') {\n      if (phoneNum.charAt(0) == '0') {\n        phoneNum = phoneNum.replace('0', '62');\n      }  \n    }\n    const alert = await this.alertController.create({\n      header: 'Verifikasi Redeem',\n      message: 'Untuk melanjutkan redeem, <br>kami akan mengirimkan OTP ke nomor '+ this.phonenumber,\n      // buttons: [\n      //       {\n      //         text: 'Tidak',\n      //         handler: () => {\n      //           // console.log('Tidak')\n      //         }\n      //       },\n      //       {\n      //         text: 'Ya, Kirimkan sekarang',\n      //         handler: () => {\n      //           // if(this.ewallettype === 'ovo') {\n      //           //   //ovo\n      //           //   this.checkOvo(phoneNum, this.selectedData['amount']);\n      //           //   //.ovo\n      //           // } else {\n      //             this.sendotp(phoneNum)\n      //           // }\n      //         }\n      //       },\n      // ]\n      buttons: [\n        {\n          text: 'Whatsapp',\n          handler: () => {\n            this.sendotp(phoneNum,'wa')\n          }\n        },\n        {\n          text: 'SMS',\n          handler: () => {\n            this.sendotp(phoneNum,'sms')\n          }\n        },\n  ]\n    });\n    await alert.present();\n  }\n\n  sendotp(n,t) {\n    this.dolphinService.sendotp(n,t).subscribe(data => {\n      this.OTP = data.otp\n      this.verifyOTP(data.otp)\n      if(t=='wa'){\n        // log auth\n        this.dolphinService.logs_auth('wa','Redeem_ewallet').subscribe(data => {});\n      } else {\n        // log auth\n        this.dolphinService.logs_auth('sms','Redeem_ewallet').subscribe(data => {});\n      }\n    });\n  }\n\n  async verifyOTP(otp_code) {\n    const alert = await this.alertController.create({\n      header: 'Konfirmasi Kode OTP',\n      message: 'Kami telah mengirimkan SMS OTP ke nomor Anda, <br>isi 5 angka dalam SMS tersebut kemudian klik konfirmasi',\n      inputs: [\n              {\n                name: 'kodeotp',\n                placeholder: 'isi dengan 5 angka kode OTP..',\n                type: 'number'\n              }],\n      buttons: [\n            {\n              text: 'Konfirmasi OTP',\n              handler: (data) => {\n                if(data.kodeotp == otp_code) {\n                  this.prosesRedeem();\n                } else {\n                  this.showalert('Oops..', 'Kode OTP tidak sesuai');\n                }\n              }\n            },\n      ]\n    });\n    await alert.present();\n  }\n\n  async prosesRedeem() {\n    this.doLoading('Memproses Saldo '+this.ewallettypeText+'...')\n    this.dolphinService.ovopointredeem(this.selectedData.redeem_code, this.selectedData.point, this.phonenumber).subscribe(data => {\n      this.loadingController.dismiss()\n      if(data.status === 'success'){\n        this.showalert(\n          'Redeem Sukses', \n          \"Berhasil menukarkan \"+ this.selectedData.gift_name + \", redeem akan segera diproses. Saldo \"+ this.ewallettypeText +\" Anda akan otomatis bertambah dan bisa Anda cek melalui aplikasi \"+ this.ewallettypeText +\" Anda. Cek pada halaman notifikasi pada aplikasi JURAGAN untuk melihat status redeem Anda.\"  \n        )\n        this.router.navigateByUrl('/', { replaceUrl: true });\n      } else {\n        if(data.status === 'err') {\n          this.showalert(\n            'Oops..', \n            data.message\n          )\n        } else {   \n          this.showalert(\n            'Oops..', \n            'Tidak dapat memproses, mohon dicoba kembali.'\n          )\n        }\n      }\n    });\n  }\n\n}\n"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}